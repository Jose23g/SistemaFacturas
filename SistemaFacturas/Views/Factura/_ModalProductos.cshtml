<div id="modalProducto" class="modal fade">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Lista de Productos</h4>
            </div>
            <div class="modal-body ">
                <div style="text-align: right" class="form-inline">
                    <div class="form-group">
                        <input type="text" style="text-align: right" placeholder="Ingresar nombre Para Buscar" class="form-control" id="dato_bus" />
                        <input type="number" class="form-control" id="cantidad" name="cantidad"/>
                    </div>
                    <button type="button" class="btn btn-primary" onclick="bus_atr()"><span class="glyphicon glyphicon-search"> Buscar</span></button>
                </div>
                <br />
                <table class="table table-bordered">
                    <thead style="background-color: darkblue; color:white">
                        <tr>
                            <th>cod</th>
                            <th>Nombre</th>
                            <th>Detalle</th>
                            <th>Precio</th>
                            <th>Disponibles</th>
                            <th>Accion</th>
                        </tr>
                    </thead>
                    <tbody id="tabla_bus_atr"></tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" data-dismiss="modal"><span class="glyphicon glyphicon-remove"> Cancelar</span></button>
            </div>
        </div>
    </div>
</div>

<script>
     //Busqueda de producto
    bus_atr = function () {
        $.post(
            '/Factura/bus_atr', {
                dato_bus: $('#dato_bus').val(),//en este caso sería el codigo
                cantidad: $('#cantidad').val()
            }, function (res) {
                $('#tabla_bus_atr').html(res)
            });
    };

    function buscar() {
        $.get('/Factura/buscar', {
            dato_bus: $('#dato_bus').val(),
            cantidad: $('#cantidad').val()
        }
           
        )
        
    }

    agr_atr = function (codProducto, nombreProducto, detalleProducto, precioProducto, Cantidad) {
        $.post(
            '/Factura/agr_atr', {
                codProducto: codProducto,
                nombreProducto: nombreProducto,
                detalleProducto: detalleProducto,
                precioProducto: precioProducto,
                cantidad: Cantidad
            }, function (res) {
                $('#tabla_atr').html(res);
                $('#tabla_bus_atr').html('');
                $('#dato_bus').val('');
            });
    };

    function agregar(){
        fetch("@Url.Content("/Factura/Obtener")")
            .then(function (res) {
                return res.json();
            })
            .then(function (JsonResult) {
                console.log(JsonResult);
                let boton_bor;
                let tabla;

                for (var i = 0; i < JsonResult.length; i++) {

                    boton_bor = "<button class=\"btn btn-danger\" type='button'"
                        + " onclick=\"bor_atr('" + JsonResult[i].codProducto + "')\""
                        + "><span class=\"glyphicon glyphicon-trash\"> Borrar</span></button>"; 

                    tabla += "<tr><td>" + JsonResult[i].codProducto + "</td>"
                        + "<td>" + JsonResult[i].nombreProducto + "</td>"
                        + "<td>" + JsonResult[i].detalleProducto + "</td>"
                        + "<td>" + JsonResult[i].precioProducto + "</td>"
                        + "<td>" + JsonResult[i].Cantidad + "</td>"
                        + "<td>" + boton_bor + "</td></tr>"
                    
                }
                document.getElementById(tabla_atr).innerHTML = tabla;
            })
    }

    bor_atr = function (id) {
        $.post(
            '/Factura/bor_atr', {
                id: id
            }, function (res) {
                $('#tabla_atr').html(res)
            });
    };

    $(document).ready(function () {
        $.post(
            '/Factura/limpiar_atr', {
            }, null
        );
    });

    $(document).ready(function () {
        setInterval(function () {
            $('total').post('/Factura/total');
        }, 2000);
    });
</script>
